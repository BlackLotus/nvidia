pkgname=rt73-k2wrlz
pkgver=3.0.2
pkgdesc="RaLink RT73 USB Enhanced Driver"
pkgrel=3
_kernver=2.6.27
_fullkernver=2.6.27.8-SLAX
_kernpath=$(pwd)/../kernel26slax/src/linux-$_kernver
arch=('i686')
license=("GPL2")
url="http://homepages.tu-darmstadt.de/~p_larbig/wlan/"
install=rt73-k2wrlz.install
source=(http://homepages.tu-darmstadt.de/~p_larbig/wlan/$pkgname-$pkgver.tar.bz2)
md5sums=('26467e32a3e627c5da2d2c10a4f7f886')
build() {
	cd "${srcdir}"/$pkgname-$pkgver/Module/
	make KERNEL_SOURCES=$_kernpath ||return 1
	mkdir -p "${pkgdir}"/lib/modules/${_fullkernver}/extra/
	install -D rt73.ko "${pkgdir}"/lib/modules/${_fullkernver}/extra/
	mkdir -p "${pkgdir}"/lib/firmware
	install rt73.bin "${pkgdir}"/lib/firmware/
	sed -i -e "s/KERNEL_VERSION='.*'/KERNEL_VERSION='${_fullkernver}'/" $startdir/*.install
}
