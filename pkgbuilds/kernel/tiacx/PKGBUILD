# Contributor: Jens Pranaitis <jens@jenux.homelinux.org>
# Contributor: James Rayner <iphitus@gmail.com>
pkgname=tiacx
pkgver=20080210
pkgrel=21
pkgdesc="OpenSource module for Texas Instruments ACX100/ACX111 wireless chips. For stock arch 2.6 kernel"
arch=(i686 x86_64)
url="http://acx100.sourceforge.net/"
license=('MPL')
depends=('wireless_tools' 'tiacx-firmware')
install=acx.install
source=(http://downloads.sourceforge.net/sourceforge/acx100/acx-$pkgver.tar.bz2 http://patches.aircrack-ng.org/acx-20070101.patch kernel-2.6.27.patch)
md5sums=('7d5ce3215708e4e9f95cf567a9ee3a12'
         '786344c994b8e36c91b2d81490c770b1'
         '9895f72f8d0c84956b0f6c3b16df0fe8')
build() {
    source "${startdir}"/../kernel.env
    cd "${srcdir}"/acx-$pkgver
    patch -Np1 -i "${srcdir}"/acx-20070101.patch
    patch -Np1 -i "${srcdir}"/kernel-2.6.27.patch
    make KERNELDIR="${_kerndir}" || return 1
    install -D acx.ko "${pkgdir}"/lib/modules/${_kernver}/kernel/drivers/net/wireless/tiacx/acx.ko
    sed -i -e "s/KERNEL_VERSION='.*'/KERNEL_VERSION='${_kernver}'/" $startdir/*.install
}
