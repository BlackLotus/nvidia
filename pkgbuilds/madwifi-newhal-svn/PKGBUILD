# Contributor: Nils Christopher Brause <mastercpp@gmx.net>
pkgname=madwifi-newhal-svn
pkgver=3875
pkgrel=5
pkgdesc="Madwifi drivers for Atheros wireless chipsets. HAL 0.10.5.6 branch. For stock arch 2.6 kernel."
arch=(i686 x86_64)
url="http://madwifi.org/"
license=('GPL')
depends=('kernel26slax')
makedepends=('subversion' 'make' 'gcc')
provides=("madwifi")
conflicts=("madwifi")
source=(http://patches.aircrack-ng.org/madwifi-ng-r3745.patch)
md5sums=(4b7b1d8836245070491fd521b0014ee0)
install=$pkgname.install

_kernver=2.6.27.4-SLAX;
_svntrunk=http://svn.madwifi.org/madwifi/branches/madwifi-hal-0.10.5.6
_svnmod=madwifi

build()
{
  cd $startdir/src
  if [ -d $_svnmod/.svn ]; then
    msg "svn update.."
    cd $_svnmod
    svn up -r $pkgver || return 1
  else
    msg "svn checkout.."
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod || return 1
    cd $_svnmod
  fi

  msg "make install-modules.."
  patch -Np1 -i $srcdir/madwifi-ng-r3745.patch || return 1
  KERNELPATH=$startdir/../kernel26slax/src/linux-2.6.27 KERNELRELEASE=$_kernver DESTDIR=$startdir/pkg make install-modules || return 1
}
